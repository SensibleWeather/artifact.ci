name: upload artifact action
description: 'Manages a deps branch and synchronizes with main branch'
inputs:
  path:
    description: A file, directory or wildcard pattern that describes what to upload
    required: true
  name:
    description: Name of the artifact to upload
    required: false
    default: artifact
  origin:
    description: The origin of the server to upload the artifact to
    required: false
    default: 'https://artifact-browser.vercel.app'
runs:
  using: composite
  steps:
    - id: upload
      uses: actions/upload-artifact@v4
      with:
        name: ${{ inputs.name }}
        path: ${{ inputs.path }}
    - id: print
      name: print url
      shell: bash
      run: |
        echo 'View your artifact here:'
        echo '${{ inputs.origin }}/artifact/browse/${{ github.repository }}/${{ github.run_id }}/${{ inputs.name }}'
    - name: install blob
      shell: bash
      run: npm install @vercel/blob tsx
    - name: prep
      shell: bash
      run: |
        echo foo > foo.txt
        sed -i 's/const res = await _undici.fetch.call/console.log("fetching", {url, options}, event);const res = await _undici.fetch.call/g' node_modules/@vercel/blob/dist/client.cjs
    - id: upload-blob
      shell: bash
      env:
        UPLOAD_FILE_PATH: foo.txt
        UPLOAD_FILE_PREFIX: ${{ inputs.origin }}/prefix/blah
      run: npx tsx upload/upload-file.ts
